# DLL注入工具

这是一个功能全面、界面友好的DLL注入工具，使用Python开发，支持多种DLL注入方法，包括常规注入和高级反射式注入。该工具主要用于系统编程学习、软件兼容性测试以及逆向工程研究等合法场景。

## 项目概述

DLL注入是一种在运行中的进程内存空间中加载并执行动态链接库的技术。本工具通过图形化界面，让用户能够方便地将指定的DLL文件注入到目标进程中，以实现扩展功能、修改行为或进行调试分析等目的。

## 功能特点

### 核心注入功能
- **常规DLL注入**：使用Windows API中的`LoadLibraryA`函数实现，稳定可靠，适合大多数场景
- **反射式DLL注入**：直接将DLL内容加载到目标进程内存并执行，无需使用`LoadLibraryA`，具有更高的隐蔽性
- **CreateThread注入**：基于`CreateRemoteThread`的注入实现，提供更详细的操作日志
- **NtCreateThreadEx注入**：使用Windows内部API的模拟实现，理论上具有更强的兼容性
- **完善的错误处理**：每一步操作都有详细的错误检查和日志记录，便于问题诊断

### 图形界面功能
- **实时进程监控**：自动加载并显示系统中所有运行进程的PID、名称、CPU使用率和内存使用情况
- **灵活的进程选择**：支持通过PID或进程名定位目标进程
- **直观的操作流程**：简化的DLL文件选择和注入方法配置界面
- **详细的操作日志**：记录每一步操作的详细信息，包括成功提示和错误信息
- **管理员权限检测**：启动时自动检测并提醒用户是否需要管理员权限

## 系统要求

- **操作系统**：Windows 7/8/10/11（32位或64位）
- **Python版本**：Python 3.6或更高版本
- **依赖库**：
  - psutil：用于获取系统进程信息
  - tkinter：Python内置GUI库，用于创建图形界面
  - ctypes：Python内置库，用于调用Windows API函数
- **权限要求**：注入系统进程或其他用户进程时，需要管理员权限

## 安装指南

### 1. 克隆或下载项目

```bash
# 克隆仓库（如果使用Git）
git clone https://github.com/Wyl-cmd/py-dll-injector.git

# 或直接下载项目源码并解压
```

### 2. 安装依赖

使用pip安装所需依赖：

```bash
pip install psutil
```

也可以直接安装requirements.txt中的所有依赖：

```bash
pip install -r requirements.txt
```

### 3. 运行程序

在项目目录下，通过以下命令运行程序：

```bash
python dll_injector_gui.py
```

或者，如果你使用的是虚拟环境：

```bash
venv\Scripts\python dll_injector_gui.py
```

## 使用方法

### 基本操作步骤

1. **启动程序**：运行`dll_injector_gui.py`脚本或可执行文件
2. **选择目标进程**：在进程列表中点击选择你想要注入DLL的目标进程
3. **选择DLL文件**：点击"浏览..."按钮，在弹出的文件选择对话框中选择要注入的DLL文件
4. **选择注入方法**：从下拉菜单中选择一种注入方法（推荐初学者使用"常规注入"）
5. **执行注入**：点击"注入DLL"按钮，在弹出的确认对话框中点击"是"开始注入
6. **查看结果**：在操作日志区域查看注入过程和结果。如果注入成功，会弹出成功提示；如果失败，会显示失败原因

### 高级功能

- **刷新进程列表**：点击"刷新列表"按钮可以更新进程列表，显示最新的运行进程
- **查看系统资源使用情况**：进程列表中显示了每个进程的CPU使用率和内存使用率，帮助你选择合适的目标进程
- **详细日志记录**：所有操作都会记录在日志区域，便于追踪和调试

## 构建可执行文件

本项目已配置好PyInstaller打包脚本，可以将程序打包成单个可执行文件，方便在没有Python环境的计算机上运行。

### 构建步骤

1. 确保已安装PyInstaller：

```bash
pip install pyinstaller
```

2. 使用提供的spec文件进行打包：

```bash
pyinstaller dll_injector_gui.spec
```

3. 打包完成后，可执行文件将位于`dist`目录下：

```bash
# 运行打包后的可执行文件
dist\dll_injector_gui.exe
```

## 技术原理详解

本工具实现了多种DLL注入技术，具体实现原理和详细的技术说明请参考项目中的[技术详解.txt](技术详解.txt)文件。该文件包含了程序的核心组件、注入方法的详细工作原理、程序执行流程以及常见问题的解决方法等内容，适合希望深入了解DLL注入技术的用户阅读。

## 常见问题解答

### Q: 为什么需要管理员权限？
A: 某些系统进程和其他用户的进程受到Windows安全机制的保护，需要管理员权限才能打开和操作这些进程。

### Q: 为什么注入操作失败？
A: 注入失败可能有多种原因，包括：目标进程已结束运行、DLL文件与目标进程位数不匹配（32位/64位）、目标进程具有特殊的保护机制等。请查看操作日志获取详细的错误信息。

### Q: 如何确定DLL文件与目标进程的位数匹配？
A: 一般来说，32位的DLL只能注入到32位的进程中，64位的DLL只能注入到64位的进程中。你可以通过任务管理器查看进程的位数信息。

### Q: 程序崩溃或无响应怎么办？
A: 尝试以管理员身份重新启动程序，或者关闭一些不必要的程序释放系统资源。如果问题仍然存在，请检查是否安装了所有必要的依赖。

## 安全与法律注意事项

1. **合法使用**：本工具仅用于学习研究和合法的软件测试目的，请勿用于非法用途或未经授权的系统修改
2. **管理员权限**：在Windows系统中，某些操作需要管理员权限才能执行，请确保在适当的情况下以管理员身份运行程序
3. **系统安全**：向系统关键进程注入DLL可能导致系统不稳定或崩溃，请谨慎操作
4. **数据保护**：在进行任何注入操作前，请确保已备份重要数据
5. **DLL来源**：请确保注入的DLL文件来源可靠，避免注入恶意代码
6. **反射式注入限制**：反射式DLL注入需要DLL文件特殊设计以支持这种注入方式。普通的DLL可能无法通过反射式注入正常工作

## 开发说明

如果您想扩展此工具的功能，可以考虑以下方向：

- 优化进程列表的筛选和搜索功能
- 实现更多类型的DLL注入技术
- 增加DLL注入的参数配置选项
- 增强日志系统，支持日志导出功能
- 添加更多的错误处理和异常情况处理

## 许可证

本项目采用MIT许可证。请在遵守相关法律法规的前提下使用本工具。

## 免责声明

- 本工具仅用于学习和研究目的，作者不对使用本工具可能造成的任何损失或法律责任负责。使用本工具即表示您同意自行承担所有风险和责任。
- QQ交流群：1154539255（没有手段估计进不去，因为被腾讯制裁了）
- 二群：521292550
